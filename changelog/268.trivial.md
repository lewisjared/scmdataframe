Refactored :meth:`RunGroupBy.apply_parallel` to allow better user control and dependency injection

Also updated associated type hints throughout `scmdata.groupby`
